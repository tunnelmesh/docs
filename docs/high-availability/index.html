<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>High Availability — TunnelMesh Docs</title>
  <link rel="icon" type="image/png" href="/img/icon.png">
  <meta name="description" content="TunnelMesh supports multiple coordinators natively. Run two or more peers in coordinator mode and they find each other automatically, replicate data between the">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;450;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/base16/monokai.min.css" id="hljs-theme">
  <link rel="stylesheet" href="/css/style.css">
  <script defer src="https://cloud.umami.is/script.js" data-website-id="52ad1994-5bcf-4035-9fc1-98494b14eb2f" data-auto-track="false"></script>
  <link rel="canonical" href="https://read.tunnelmesh.io/docs/high-availability/">
  <meta property="og:title" content="High Availability — TunnelMesh Docs">
  <meta property="og:description" content="TunnelMesh supports multiple coordinators natively. Run two or more peers in coordinator mode and they find each other automatically, replicate data between the">
  <meta property="og:url" content="https://read.tunnelmesh.io/docs/high-availability/">
  <meta property="og:type" content="website">
</head>
<body>

<!-- ── Navigation ── -->
<nav class="nav" id="nav">
  <div class="nav-inner">

    <a href="#/docs" class="logo">
      <img src="/img/icon.png" class="logo-img" width="30" height="30" alt="TunnelMesh">
      <span class="logo-word">tunnelmesh</span>
      <span class="logo-tag">docs</span>
    </a>

    <div class="nav-center">
      <button class="nav-tab active" data-view="docs" aria-label="Documentation">
        <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
          <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
        </svg>
        Docs
      </button>
      <button class="nav-tab" data-view="blog" aria-label="Blog">
        <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <path d="M12 20h9"/>
          <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/>
        </svg>
        Blog
      </button>
    </div>

    <div class="nav-actions">
      <a href="https://tunnelmesh.io" class="nav-icon-link" target="_blank" rel="noopener" aria-label="TunnelMesh website" title="Website">
        <svg width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <circle cx="12" cy="12" r="10"/>
          <line x1="2" y1="12" x2="22" y2="12"/>
          <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
        </svg>
      </a>
      <a href="https://github.com/tunnelmesh/tunnelmesh" class="nav-icon-link" target="_blank" rel="noopener" aria-label="GitHub" title="GitHub">
        <svg width="17" height="17" viewBox="0 0 98 96" fill="currentColor" aria-hidden="true">
          <path fill-rule="evenodd" clip-rule="evenodd" d="M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z"/>
        </svg>
      </a>
      <button class="theme-toggle" id="theme-toggle" aria-label="Toggle light/dark mode">
        <svg class="icon-sun" width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <circle cx="12" cy="12" r="5"/>
          <line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/>
          <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
          <line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/>
          <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
        </svg>
        <svg class="icon-moon" width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
        </svg>
      </button>
    </div>

    <button class="hamburger" id="hamburger" aria-label="Toggle sidebar">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
        <line x1="3" y1="6" x2="21" y2="6"/>
        <line x1="3" y1="12" x2="21" y2="12"/>
        <line x1="3" y1="18" x2="21" y2="18"/>
      </svg>
    </button>

  </div>
</nav>

<!-- Mobile overlay -->
<div class="sidebar-overlay" id="sidebar-overlay"></div>

<!-- ── App Layout ── -->
<div class="app-wrap">

  <!-- ══ DOCS VIEW ══ -->
  <div class="view active" id="view-docs">

    <!-- Left sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-scroll">
        <div class="sidebar-section-label">Documentation</div>
        <nav id="sidebar-nav" class="sidebar-nav" aria-label="Documentation navigation"></nav>
      </div>
    </aside>

    <!-- Center content -->
    <main class="docs-main">
      <div class="docs-content">
        <article id="doc-article" class="doc-article" aria-live="polite"><h1 id="coordinator-high-availability">Coordinator High Availability</h1>
<p>TunnelMesh supports multiple coordinators natively. Run two or more peers in coordinator mode and they find each other automatically, replicate data between themselves, and rebalance when the cluster topology changes. There is no single point of failure, no external load balancer required, and no shared filesystem.</p>
<h2 id="how-it-works">How It Works</h2>
<p>Every coordinator is an equal peer: there is no leader, no primary, no replica distinction. When a coordinator joins the mesh it registers with <code>is_coordinator: true</code>, and every other coordinator in the cluster is notified and adds it to the replication pool.</p>
<p>Data is distributed across coordinators using chunk-level striping: each chunk of each object has a deterministic primary owner (<code>chunk_index mod num_coordinators</code>), and replicas are placed on the next N−1 coordinators in the ring. Concurrent writes are reconciled with version vectors, falling back to last-modified timestamp as a tiebreaker.</p>
<img src="/docs/images/coordinator-ha.svg" alt="Coordinator HA: two coordinator peers connected by chunk replication arrows, with mesh peers fanning out below both">

<h2 id="setup">Setup</h2>
<p>Point multiple peers at the same mesh. Configure each with coordinator mode enabled and its own local data directory; replication takes care of distribution, with no shared storage needed.</p>
<pre><code class="language-yaml"># coordinator-a.yaml
name: &quot;coordinator-a&quot;

coordinator:
  enabled: true
  listen: &quot;:8443&quot;
  data_dir: &quot;/var/lib/tunnelmesh&quot;
  admin_peers:
    - &quot;a1b2c3d4e5f6g7h8&quot;   # coordinator-a&#39;s peer ID
    - &quot;b2c3d4e5f6g7h8i9&quot;   # coordinator-b&#39;s peer ID
</code></pre>
<pre><code class="language-yaml"># coordinator-b.yaml
name: &quot;coordinator-b&quot;

coordinator:
  enabled: true
  listen: &quot;:8443&quot;
  data_dir: &quot;/var/lib/tunnelmesh&quot;
  admin_peers:
    - &quot;a1b2c3d4e5f6g7h8&quot;
    - &quot;b2c3d4e5f6g7h8i9&quot;
</code></pre>
<p>Start both coordinators and have them join the same mesh. They discover each other through peer registration. No seed addresses or extra configuration are needed.</p>
<pre><code class="language-bash"># On host A — bootstraps the mesh
tunnelmesh join --config coordinator-a.yaml

# On host B — joins the existing mesh
tunnelmesh join coordinator-a.example.com:8443 --token your-token --config coordinator-b.yaml
</code></pre>
<p>Once coordinator-b has joined, coordinator-a receives the registration, sees <code>is_coordinator: true</code>, adds coordinator-b to the replication pool, and broadcasts the updated coordinator list to all mesh peers.</p>
<h2 id="replication">Replication</h2>
<p>Replication is asynchronous and queue-based. When an object is written to coordinator-a:</p>
<ol>
<li>The write completes locally and is acknowledged to the client</li>
<li>coordinator-a enqueues a replication task</li>
<li>A background worker sends the chunk(s) to all peer coordinators in parallel (up to 5 concurrent operations, 60s per-peer timeout)</li>
<li>If a coordinator is unreachable, the task retries with exponential backoff (up to 3 attempts)</li>
<li>A periodic safety-net sync runs every 5 minutes: coordinator-a sends a full manifest of locally-owned objects; peers delete anything not in the manifest (handles lost delete messages)</li>
</ol>
<p>Reads can be served from any coordinator. Clients that connect to coordinator-b while coordinator-a is down continue to operate on the replicated data.</p>
<div class="callout note">
  <div class="callout-title"><span>Note</span></div>
  <div class="callout-body"><p>TunnelMesh uses <strong>eventual consistency</strong> with deterministic conflict resolution. During a network partition where both coordinators accept writes to the same object, the conflict is resolved when connectivity is restored using version vectors; last-modified timestamp breaks ties.</p></div>
</div>
<h2 id="scaling">Scaling</h2>
<p>Add more coordinators the same way: just join additional peers with coordinator mode enabled. The replication pool expands automatically, chunk assignments rebalance within 10 seconds (debounced), and at most 50 MB is transferred per rebalance cycle to avoid saturating the mesh.</p>
<pre><code class="language-bash"># Add a third coordinator
tunnelmesh join coordinator-a.example.com:8443 --token your-token --config coordinator-c.yaml
</code></pre>
<div class="callout tip">
  <div class="callout-title"><span>Tip</span></div>
  <div class="callout-body"><p>For cloud deployments, the Terraform modules in <a href="CLOUD_DEPLOYMENT.md">Cloud Deployment</a> provision coordinator nodes alongside the rest of your infrastructure.</p></div>
</div>
<h2 id="what-peers-see">What Peers See</h2>
<p>Mesh peers receive the full list of coordinator mesh IPs in the <code>RegisterResponse</code>. When a coordinator is added or removed, the updated list is broadcast to all peers so they can reconnect through a healthy coordinator without manual reconfiguration.</p>
<h2 id="related-documentation">Related Documentation</h2>
<ul>
<li><strong><a href="CLOUD_DEPLOYMENT.md">Cloud Deployment</a></strong>: Terraform provisioning for coordinator nodes</li>
<li><strong><a href="ADMIN.md">Admin Guide</a></strong>: Coordinator configuration reference</li>
<li><strong><a href="DOCKER.md">Docker Deployment</a></strong>: Multi-coordinator Docker Compose setup for local testing</li>
</ul>
<hr>
<p><em>TunnelMesh is released under the <a href="https://github.com/tunnelmesh/tunnelmesh/blob/main/LICENSE">AGPL-3.0 License</a>.</em></p>
</article>
        <nav id="doc-pagination" class="doc-pagination" aria-label="Document navigation"></nav>
      </div>
    </main>

    <!-- Right page TOC -->
    <aside class="page-toc" id="page-toc" aria-label="Page contents">
      <div class="page-toc-label">On this page</div>
      <nav id="page-toc-nav" class="page-toc-nav"></nav>
    </aside>

  </div>

  <!-- ══ BLOG VIEW ══ -->
  <div class="view hidden" id="view-blog">
    <main class="blog-main" id="blog-main" aria-live="polite">
      <div class="doc-loading">
        <div class="loading-spinner"></div>
        <span>Loading…</span>
      </div>
    </main>
  </div>

</div>

<!-- ── Footer ── -->
<footer class="site-footer">
  <p>© 2026 FORGE3D CYF. Registered in Wales, Company No. 16891098.</p>
</footer>

<!-- ── Scripts ── -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/marked/9.1.6/marked.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/powershell.min.js"></script>
<script src="/js/app.js"></script>
<script>window.__PRERENDERED = {"type":"doc","id":"HIGH_AVAILABILITY"};</script>
</body>
</html>
