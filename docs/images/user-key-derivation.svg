<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 580 300" font-family="'Inter', sans-serif">
  <rect width="100%" height="100%" fill="#0a1018"/>
  <defs>
    <marker id="a" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <polygon points="0 0 8 3 0 6" fill="#00d4b4"/>
    </marker>
  </defs>
  <!-- ── Left chain: User ID derivation ── -->
  <!-- Box 1: SSH Key -->
  <rect x="15" y="20" width="200" height="44" rx="6" fill="#0c1220" stroke="rgba(255,255,255,0.12)" stroke-width="1"/>
  <text x="115" y="42" text-anchor="middle" dominant-baseline="middle" fill="#e8eaf0" font-size="13">SSH Key (id_ed25519)</text>
  <!-- Arrow 1→2 -->
  <line x1="115" y1="64" x2="115" y2="92" stroke="#00d4b4" stroke-width="1.5" marker-end="url(#a)"/>
  <!-- Box 2: ED25519 Public Key (shared with S3 chain) -->
  <rect x="15" y="92" width="200" height="44" rx="6" fill="#0c1220" stroke="rgba(255,255,255,0.12)" stroke-width="1"/>
  <text x="115" y="114" text-anchor="middle" dominant-baseline="middle" fill="#e8eaf0" font-size="13">ED25519 Public Key</text>
  <!-- Arrow 2→3 with label -->
  <line x1="115" y1="136" x2="115" y2="164" stroke="#00d4b4" stroke-width="1.5" marker-end="url(#a)"/>
  <text x="127" y="152" dominant-baseline="middle" fill="rgba(232,234,240,0.35)" font-size="10">hash + truncate</text>
  <!-- Box 3: SHA256 hash -->
  <rect x="15" y="164" width="200" height="44" rx="6" fill="#0c1220" stroke="rgba(255,255,255,0.12)" stroke-width="1"/>
  <text x="115" y="186" text-anchor="middle" dominant-baseline="middle" fill="#e8eaf0" font-size="12">SHA256(pubkey)[:8] as hex</text>
  <!-- Arrow 3→4 -->
  <line x1="115" y1="208" x2="115" y2="236" stroke="#00d4b4" stroke-width="1.5" marker-end="url(#a)"/>
  <!-- Box 4: User ID (accent) -->
  <rect x="15" y="236" width="200" height="44" rx="6" fill="#0c1220" stroke="rgba(0,212,180,0.3)" stroke-width="1.5"/>
  <text x="115" y="258" text-anchor="middle" dominant-baseline="middle" fill="#00d4b4" font-size="13">User ID (16 hex chars)</text>
  <!-- ── Right branch: S3 credentials ── -->
  <text x="390" y="46" text-anchor="middle" fill="rgba(232,234,240,0.35)" font-size="11">S3 Credentials</text>
  <!-- Horizontal stem from Public Key box right side -->
  <line x1="215" y1="114" x2="258" y2="114" stroke="rgba(232,234,240,0.25)" stroke-width="1"/>
  <!-- Vertical fork trunk -->
  <line x1="258" y1="80" x2="258" y2="148" stroke="rgba(232,234,240,0.25)" stroke-width="1"/>
  <!-- Top branch → HKDF access-key -->
  <line x1="258" y1="80" x2="290" y2="80" stroke="#00d4b4" stroke-width="1.5" marker-end="url(#a)"/>
  <rect x="290" y="60" width="172" height="40" rx="6" fill="#0c1220" stroke="rgba(255,255,255,0.12)" stroke-width="1"/>
  <text x="376" y="80" text-anchor="middle" dominant-baseline="middle" fill="rgba(232,234,240,0.52)" font-size="11">HKDF('s3-access-key')</text>
  <line x1="462" y1="80" x2="480" y2="80" stroke="#00d4b4" stroke-width="1.5" marker-end="url(#a)"/>
  <rect x="480" y="60" width="92" height="40" rx="6" fill="#0c1220" stroke="rgba(0,212,180,0.3)" stroke-width="1.5"/>
  <text x="526" y="74" text-anchor="middle" dominant-baseline="middle" fill="#e8eaf0" font-size="11">Access Key</text>
  <text x="526" y="90" text-anchor="middle" dominant-baseline="middle" fill="rgba(232,234,240,0.52)" font-size="10">(20 chars)</text>
  <!-- Bottom branch → HKDF secret-key -->
  <line x1="258" y1="148" x2="290" y2="148" stroke="#00d4b4" stroke-width="1.5" marker-end="url(#a)"/>
  <rect x="290" y="128" width="172" height="40" rx="6" fill="#0c1220" stroke="rgba(255,255,255,0.12)" stroke-width="1"/>
  <text x="376" y="148" text-anchor="middle" dominant-baseline="middle" fill="rgba(232,234,240,0.52)" font-size="11">HKDF('s3-secret-key')</text>
  <line x1="462" y1="148" x2="480" y2="148" stroke="#00d4b4" stroke-width="1.5" marker-end="url(#a)"/>
  <rect x="480" y="128" width="92" height="40" rx="6" fill="#0c1220" stroke="rgba(0,212,180,0.3)" stroke-width="1.5"/>
  <text x="526" y="142" text-anchor="middle" dominant-baseline="middle" fill="#e8eaf0" font-size="11">Secret Key</text>
  <text x="526" y="158" text-anchor="middle" dominant-baseline="middle" fill="rgba(232,234,240,0.52)" font-size="10">(40 chars)</text>
</svg>
